<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Understanding and Mitigating LLM Hallucinations | Olivier MF Martin</title>
<meta name=keywords content><meta name=description content="How can we detect and mitigate hallucinations for safer LLM deployment?"><meta name=author content="Olivier MF Martin"><link rel=canonical href=https://omfmartin.com/posts/2024-03-24-llm-hallucination/><link crossorigin=anonymous href=/assets/css/stylesheet.c7ada1ec5c18a60093054264541f69ef87055a2648305df1f1d6dd520e8e1f5e.css integrity="sha256-x62h7FwYpgCTBUJkVB9p74cFWiZIMF3x8dbdUg6OH14=" rel="preload stylesheet" as=style><link rel=icon href=https://omfmartin.com/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://omfmartin.com/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://omfmartin.com/favicon-32x32.png><link rel=apple-touch-icon href=https://omfmartin.com/apple-touch-icon.png><link rel=mask-icon href=https://omfmartin.com/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://omfmartin.com/posts/2024-03-24-llm-hallucination/><link rel=alternate hreflang=es href=https://omfmartin.com/es/posts/2024-03-24-llm-hallucination/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><link rel=stylesheet href=/assets/css/extended/style.css><script async src="https://www.googletagmanager.com/gtag/js?id=G-PKR8VY4E8L"></script><script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-PKR8VY4E8L",{anonymize_ip:!1})}</script><meta property="og:title" content="Understanding and Mitigating LLM Hallucinations"><meta property="og:description" content="How can we detect and mitigate hallucinations for safer LLM deployment?"><meta property="og:type" content="article"><meta property="og:url" content="https://omfmartin.com/posts/2024-03-24-llm-hallucination/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2024-03-24T00:00:00+00:00"><meta property="article:modified_time" content="2024-03-24T00:00:00+00:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="Understanding and Mitigating LLM Hallucinations"><meta name=twitter:description content="How can we detect and mitigate hallucinations for safer LLM deployment?"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://omfmartin.com/posts/"},{"@type":"ListItem","position":2,"name":"Understanding and Mitigating LLM Hallucinations","item":"https://omfmartin.com/posts/2024-03-24-llm-hallucination/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Understanding and Mitigating LLM Hallucinations","name":"Understanding and Mitigating LLM Hallucinations","description":"How can we detect and mitigate hallucinations for safer LLM deployment?","keywords":[],"articleBody":"Large Language Models (LLMs) make stuff up. Occasionally, these models will generate content that, while seemingly entirely plausible, is fundamentally incorrect. This phenomenon is known as “hallucinations”.\nHallucinations can have disastrous consequences. They can spread misinformation, potentially offend users, and even compromise sensitive information. This issue is a major drawback of LLMs and is the reason why many are cautious about employing them in real-world settings.\nIn this article, we will discuss what hallucinations are, explain why they happen, and explore strategies to detect and mitigate them.\nWhat are Hallucinations? Hallucinations can be loosely defined as output that is factually incorrect, unfaithful to the provided information, or nonsensical. Most often, the model will appear quite confident and its response may even look entirely plausible. This makes detecting hallucinations a difficult task. Generally, hallucinations fall into two categories: intrinsic and extrinsic.\nIntrinsic hallucinations happen when the model’s output directly contradicts the information it was given. For example:\nPrompt: The capital of France is Paris. What is the capital of France? Response: The capital of France is Lyon.\nExtrinsic hallucinations occur when the model makes statements that cannot be verified or contradicted based on the provided information. For example:\nPrompt: Describe the economic impact of renewable energy sources. Response: According to a 2045 report, renewable energy sources have led to the creation of 5 million new jobs worldwide.\nWhy do LLMs Hallucinate? Hallucinations in language models are thought to be unavoidable. They can occur factors due to a variety of factors, which can be broadly classified into issues related to data, training process, and inference.\nData-Related Causes Inaccuracies in Training Data: Training data is the foundation of LLMs. However, data is not always of the best quality and may be inaccurate or biased. Given the vast amount of data processed, ensuring its accuracy and relevance is challenging. This implies that some of the information learned by the model will lead it to generate misleading or incorrect responses. Out-of-Distribution Queries: LLMs are trained on datasets that cover certain topics, time periods, and types of information. When faced with questions or tasks that lie outside of these boundaries, a language model may generate incorrect answers. For instance, asking about the latest news events will result in answers based on outdated or irrelevant information. Data Utilization Issues: How language models utilize their knowledge base can also contribute to hallucinations. Language models tend to rely on word co-occurrence patterns to generate responses. This reliance might lead to incorrect conclusions, such as identifying Sydney as the capital of Australia due to their more frequent association compared to the correct answer, Canberra. Training-Related Causes Exposure Bias: This issue arises from a discrepancy between how the model is trained and the model’s actual use case. During training, the model learns to predict the next token relying on the previous correct sequence from the training data, a method known as “teacher forcing.” However, during inference, the model relies on its outputs. This can lead to an accumulation of errors or snowball effect. Architectural Limitations: Causal language models generate text by predicting the next token based solely on preceding tokens. This design limits the model’s ability to fully grasp contextual nuances, which is believed to contribute to the generation of hallucinated content. Belief Misalignment: LLMs typically undergo a two-stage training process. Initially, they are pretrained to acquire broad knowledge. Subsequently, they are fine-tuned to better align with specific user instructions or prompts, often using techniques like reinforcement learning. This fine-tuning might inadvertently lead the model to prioritize user preferences over accuracy. Inference-Related Causes Randomness in Sampling: The decoding strategies of language models often incorporate some randomness to enhance creativity and output quality, for example by adjusting the temperature parameter to favor less likely choices. This approach can inadvertently increase the likelihood of generating nonsensical content. Softmax Bottleneck: The last layer of an LLM estimates the probability of the next token. The majority of LLMs use a softmax layer, which is known to have a limitation called the softmax bottleneck. This limitation impedes the model’s capacity to distinguish among highly probable outcomes effectively. Diluted Attention: With longer input sequences, the efficiency of the model’s attention mechanism may decline, leading to a weakened focus on essential details and context. This dilution of attention compromises the model’s ability to remain coherent and accurate over extended texts. How can we detect hallucinations? Detecting hallucinations presents significant challenges that standard metrics used in Natural Language Processing such as BLEU, ROUGE, or BERTScore fail to address. Not only do these metrics fail to accurately predict hallucinations, but also rely on reference response, which is impractical for widespread applications.\nOne approach for hallucination detection is to employ probabilistic metrics that calculate the likelihood of hallucinations based on token probabilities or entropy measures, for example by estimating perplexity. However, these metrics require access to token probabilities, which may not be available, which limits their adoption.\nA more effective strategy has been the development of model-based metrics. This approach involves utilizing another language model, for example, a state-of-the-art LLM, to assess the likelihood of hallucinatory content. These metrics can be further classified into token-level and sentence-level metrics.\nToken-level metrics attempt to predict for each token if it was hallucinated or not. To implement this strategy, researchers typically generate a synthetic hallucinated dataset by applying perturbations to reference datasets free of hallucinations. A binary language classifier, such as one based on BERT or XLNet, is then trained to discern hallucinated tokens from non-hallucinated ones. Notable projects utilizing this approach are HADES and fairseq-detect-hallucination hallucination detection pipeline.\nOn the other hand, sentence-level metrics evaluate the entire sentence to determine the presence of hallucinations. A prominent method is SelfCheckGPT, a sampling-based technique grounded in the assumption that hallucinations are more likely to occur when the model is uncertain. This method assesses self-consistency by comparing various sampled responses, using standard metrics such as N-gram matching or BERTScore, to estimate the probability of hallucinatory content. One strength of this method is that it does not require any external data, making it easily scalable.\nStrategies for Mitigating Hallucinations Hallucination mitigation strategies aim at reducing the likelihood of an LLM generating hallucinatory content. Below, we explore several techniques, ordered from straightforward adjustments to more complex interventions.\n1. Adjusting Inference Parameters One of the simplest methods to reduce hallucinations involves tweaking the LLM’s operational settings. For instance, fine-tuning parameters such as the generation temperature and top-k sampling can regulate the randomness of the LLM’s output. Lower temperature or top-k values may yield more cautious and conservative responses, thereby potentially minimizing hallucinatory outputs.\n2. Prompt Engineering Effective prompt engineering is crucial for steering LLMs toward accurate responses. The following general tips are essential for optimizing prompts:\nClarity and Precision: Ensure the prompt is clear about the exact type of information required.\nUncertainty Acknowledgement: Explicitly request that the model should avoid making up information and express uncertainty when applicable, for example by saying “I don’t know”.\nEmphasis on Key Information: Repeating important details within the prompt can help underline the importance of these elements. This helps ensure that they receive due attention in the model’s response.\nStrategic Information Placement: Positioning the most crucial information towards the end of the prompt can enhance the model’s focus on these key details.\nOutput Format Specification: Directing the model to structure its response in a specific format can help in obtaining information that is organized in a manner that best suits the user’s needs.\nFurthermore, more advanced prompt engineering techniques offer additional layers of sophistication:\nMulti-shot Prompting involves providing the model with multiple examples of the desired output. This approach helps the model grasp the context better and align its responses with the expected answer format.\nChain of Thought encourages the model to exhibit its reasoning process step-by-step, offering users insights into the logical progression leading to a given answer.\nSelf-consistency involves generating several responses and selecting the one that demonstrates the highest degree of internal consistency, thereby improving reliability.\nChain of Verification is a technique where the model is used to verify its outputs or make annotations, further enhancing the accuracy and trustworthiness of the information provided.\n3. Retrieval-based Approaches These approaches enhance the model’s responses by incorporating external knowledge sources and context to the prompt. Probably the most known technique is Retrieval Augmented Generation (RAG):. This approach encodes external documents as sentence embedding, usually using some transformer-based neural network such as BERT. The resulting embeddings are then stored in a vector database, which can then be efficiently queried using the original prompt (or some variation). The retrieved sentences are then used to enrich the prompt. A popular framework is FAISS. The main drawback of these retrieval-based approaches is that they require maintaining a large and curated database.\n4. LLM Fine-tuning The quality of a model’s output directly depends on its training data. Fine-tuning an LLM with updated or more relevant data can address specific weaknesses or gaps in its knowledge base. While retraining from scratch is often impractical, fine-tuning offers a cost-effective alternative for enhancing model accuracy in targeted applications. Techniques such as LoRA help reduce the number of trainable parameters which accelerates the fine-tuning making it a viable option.\nClosing Thought There is a fine line between creativity and hallucinations. On one hand, a model that leans too much towards caution may avoid hallucinations but at the cost of producing responses that are uninteresting or too simplistic. On the other hand, an overly creative model will produce outputs that resemble an interview with Salvador Dali.\nFinding the right balance is key to harnessing the full potential of LLM while minimizing the risks associated with hallucinations. Ultimately, understanding and mitigating hallucinations is not only about preventing errors; it’s about building trust between humans and artificial intelligence, ensuring that these tools enhance our decision-making processes, creativity, and access to information.\nBibliography Huang et al. A Survey on Hallucination in Large Language Models: Principles, Taxonomy, Challenges, and Open Questions. (2023) Ji et al. Survey of Hallucination in Natural Language Generation. (2022) Luo et al. Hallucination Detection and Hallucination Mitigation: An Investigation. (2024) Manakul et al. SelfCheckGPT: Zero-Resource Black-Box Hallucination Detection for Generative Large Language Models. (2023) Xu et al. Hallucination is Inevitable: An Innate Limitation of Large Language Models. (2024) Zhou et al. Detecting Hallucinated Content in Conditional Neural Sequence Generation. (2020) ","wordCount":"1718","inLanguage":"en","datePublished":"2024-03-24T00:00:00Z","dateModified":"2024-03-24T00:00:00Z","author":{"@type":"Person","name":"Olivier MF Martin"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://omfmartin.com/posts/2024-03-24-llm-hallucination/"},"publisher":{"@type":"Organization","name":"Olivier MF Martin","logo":{"@type":"ImageObject","url":"https://omfmartin.com/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://omfmartin.com accesskey=h title="Olivier MF Martin (Alt + H)">Olivier MF Martin</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button><ul class=lang-switch><li>|</li><li><a href=https://omfmartin.com/es/ title=Español aria-label=Español>Español</a></li></ul></div></div><ul id=menu><li><a href=https://omfmartin.com/posts/ title=Blog><span>Blog</span></a></li><li><a href=https://omfmartin.com/about-me title="About Me"><span>About Me</span></a></li><li><a href=https://omfmartin.com/search title="Search (Alt + /)" accesskey=/><span>Search</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class="post-title entry-hint-parent">Understanding and Mitigating LLM Hallucinations</h1><div class=post-meta><span title='2024-03-24 00:00:00 +0000 UTC'>March 24, 2024</span>&nbsp;·&nbsp;9 min&nbsp;·&nbsp;Olivier MF Martin&nbsp;|&nbsp;Translations:<ul class=i18n_list><li><a href=https://omfmartin.com/es/posts/2024-03-24-llm-hallucination/>Español</a></li></ul></div></header><div class=post-content><p><strong>Large Language Models (LLMs) make stuff up</strong>. Occasionally, these models will generate content that, while seemingly entirely plausible, is fundamentally incorrect. This phenomenon is known as &ldquo;hallucinations&rdquo;.</p><p><strong>Hallucinations can have disastrous consequences</strong>. They can spread misinformation, potentially offend users, and even compromise sensitive information. This issue is a major drawback of LLMs and is the reason why many are cautious about employing them in real-world settings.</p><p>In this article, we will discuss what hallucinations are, explain why they happen, and explore strategies to detect and mitigate them.</p><p><img loading=lazy src=hallucinating_llm.png alt="A surreal and psychedelic painting that portrays a linguistic model embarking on a hallucinatory and mind-altering journey."></p><h2 id=what-are-hallucinations>What are Hallucinations?<a hidden class=anchor aria-hidden=true href=#what-are-hallucinations>#</a></h2><p>Hallucinations can be loosely defined as output that is <strong>factually incorrect, unfaithful to the provided information, or nonsensical</strong>. Most often, the model will appear quite confident and its response may even look entirely plausible. This makes detecting hallucinations a difficult task. Generally, hallucinations fall into two categories: intrinsic and extrinsic.</p><p><strong>Intrinsic hallucinations</strong> happen when the model&rsquo;s output directly contradicts the information it was given. For example:</p><blockquote><blockquote><blockquote><p><strong>Prompt</strong>: The capital of France is Paris. What is the capital of France?
<strong>Response</strong>: The capital of France is Lyon.</p></blockquote></blockquote></blockquote><p><strong>Extrinsic hallucinations</strong> occur when the model makes statements that cannot be verified or contradicted based on the provided information. For example:</p><blockquote><blockquote><blockquote><p><strong>Prompt</strong>: Describe the economic impact of renewable energy sources.
<strong>Response</strong>: According to a 2045 report, renewable energy sources have led to the creation of 5 million new jobs worldwide.</p></blockquote></blockquote></blockquote><h2 id=why-do-llms-hallucinate>Why do LLMs Hallucinate?<a hidden class=anchor aria-hidden=true href=#why-do-llms-hallucinate>#</a></h2><p>Hallucinations in language models are thought to be unavoidable. They can occur factors due to a variety of factors, which can be broadly classified into issues related to data, training process, and inference.</p><h3 id=data-related-causes>Data-Related Causes<a hidden class=anchor aria-hidden=true href=#data-related-causes>#</a></h3><ul><li><strong>Inaccuracies in Training Data</strong>: Training data is the foundation of LLMs. However, data is not always of the best quality and may be inaccurate or biased. Given the vast amount of data processed, ensuring its accuracy and relevance is challenging. This implies that some of the information learned by the model will lead it to generate misleading or incorrect responses.</li><li><strong>Out-of-Distribution Queries</strong>: LLMs are trained on datasets that cover certain topics, time periods, and types of information. When faced with questions or tasks that lie outside of these boundaries, a language model may generate incorrect answers. For instance, asking about the latest news events will result in answers based on outdated or irrelevant information.</li><li><strong>Data Utilization Issues</strong>: How language models utilize their knowledge base can also contribute to hallucinations. Language models tend to rely on word co-occurrence patterns to generate responses. This reliance might lead to incorrect conclusions, such as identifying Sydney as the capital of Australia due to their more frequent association compared to the correct answer, Canberra.</li></ul><h3 id=training-related-causes>Training-Related Causes<a hidden class=anchor aria-hidden=true href=#training-related-causes>#</a></h3><ul><li><strong>Exposure Bias</strong>: This issue arises from a discrepancy between how the model is trained and the model&rsquo;s actual use case. During training, the model learns to predict the next token relying on the previous correct sequence from the training data, a method known as &ldquo;teacher forcing.&rdquo; However, during inference, the model relies on its outputs. This can lead to an accumulation of errors or snowball effect.</li><li><strong>Architectural Limitations</strong>: Causal language models generate text by predicting the next token based solely on preceding tokens. This design limits the model&rsquo;s ability to fully grasp contextual nuances, which is believed to contribute to the generation of hallucinated content.</li><li><strong>Belief Misalignment</strong>: LLMs typically undergo a two-stage training process. Initially, they are pretrained to acquire broad knowledge. Subsequently, they are fine-tuned to better align with specific user instructions or prompts, often using techniques like <a href=https://en.wikipedia.org/wiki/Reinforcement_learning>reinforcement learning</a>. This fine-tuning might inadvertently lead the model to prioritize user preferences over accuracy.</li></ul><h3 id=inference-related-causes>Inference-Related Causes<a hidden class=anchor aria-hidden=true href=#inference-related-causes>#</a></h3><ul><li><strong>Randomness in Sampling</strong>: The decoding strategies of language models often incorporate some randomness to enhance creativity and output quality, for example by adjusting the temperature parameter to favor less likely choices. This approach can inadvertently increase the likelihood of generating nonsensical content.</li><li><strong>Softmax Bottleneck</strong>: The last layer of an LLM estimates the probability of the next token. The majority of LLMs use a softmax layer, which is known to have a limitation called the softmax bottleneck. This limitation impedes the model&rsquo;s capacity to distinguish among highly probable outcomes effectively.</li><li><strong>Diluted Attention</strong>: With longer input sequences, the efficiency of the model’s attention mechanism may decline, leading to a weakened focus on essential details and context. This dilution of attention compromises the model&rsquo;s ability to remain coherent and accurate over extended texts.</li></ul><h2 id=how-can-we-detect-hallucinations>How can we detect hallucinations?<a hidden class=anchor aria-hidden=true href=#how-can-we-detect-hallucinations>#</a></h2><p>Detecting hallucinations presents significant challenges that standard metrics used in Natural Language Processing such as <a href=https://en.wikipedia.org/wiki/BLEU>BLEU</a>, <a href=https://en.wikipedia.org/wiki/ROUGE_(metric)>ROUGE</a>, or <a href=https://en.wikipedia.org/wiki/Sentence_embedding>BERTScore</a> fail to address. Not only do these metrics fail to accurately predict hallucinations, but also rely on reference response, which is impractical for widespread applications.</p><p>One approach for hallucination detection is to employ <strong>probabilistic metrics</strong> that calculate the likelihood of hallucinations based on token probabilities or entropy measures, for example by estimating <a href=https://en.wikipedia.org/wiki/Perplexity>perplexity</a>. However, these metrics require access to token probabilities, which may not be available, which limits their adoption.</p><p>A more effective strategy has been the development of <strong>model-based metrics</strong>. This approach involves utilizing another language model, for example, a state-of-the-art LLM, to assess the likelihood of hallucinatory content. These metrics can be further classified into token-level and sentence-level metrics.</p><p><strong>Token-level metrics</strong> attempt to predict for each token if it was hallucinated or not. To implement this strategy, researchers typically generate a synthetic hallucinated dataset by applying perturbations to reference datasets free of hallucinations. A binary language classifier, such as one based on <a href=https://en.wikipedia.org/wiki/BERT_(language_model)>BERT</a> or <a href=https://doi.org/10.48550/arXiv.1906.08237>XLNet</a>, is then trained to discern hallucinated tokens from non-hallucinated ones. Notable projects utilizing this approach are <a href=https://github.com/microsoft/HaDes>HADES</a> and <a href=https://github.com/violet-zct/fairseq-detect-hallucination>fairseq-detect-hallucination</a> hallucination detection pipeline.</p><p>On the other hand, <strong>sentence-level metrics</strong> evaluate the entire sentence to determine the presence of hallucinations. A prominent method is <a href=https://github.com/potsawee/selfcheckgpt>SelfCheckGPT</a>, a sampling-based technique grounded in the assumption that hallucinations are more likely to occur when the model is uncertain. This method assesses self-consistency by comparing various sampled responses, using standard metrics such as N-gram matching or BERTScore, to estimate the probability of hallucinatory content. One strength of this method is that it does not require any external data, making it easily scalable.</p><h2 id=strategies-for-mitigating-hallucinations>Strategies for Mitigating Hallucinations<a hidden class=anchor aria-hidden=true href=#strategies-for-mitigating-hallucinations>#</a></h2><p>Hallucination mitigation strategies aim at reducing the likelihood of an LLM generating hallucinatory content. Below, we explore several techniques, ordered from straightforward adjustments to more complex interventions.</p><p><img loading=lazy src=llm_waking_up.png alt="Visualize a moment capturing the aftermath of a hallucinatory journey for a linguistic model."></p><h3 id=1-adjusting-inference-parameters>1. Adjusting Inference Parameters<a hidden class=anchor aria-hidden=true href=#1-adjusting-inference-parameters>#</a></h3><p>One of the simplest methods to reduce hallucinations involves tweaking the LLM&rsquo;s operational settings. For instance, fine-tuning parameters such as the generation temperature and top-k sampling can regulate the randomness of the LLM&rsquo;s output. Lower temperature or top-k values may yield more cautious and conservative responses, thereby potentially minimizing hallucinatory outputs.</p><h3 id=2-prompt-engineering>2. Prompt Engineering<a hidden class=anchor aria-hidden=true href=#2-prompt-engineering>#</a></h3><p>Effective prompt engineering is crucial for steering LLMs toward accurate responses. The following general tips are essential for optimizing prompts:</p><ul><li><p><strong>Clarity and Precision</strong>: Ensure the prompt is clear about the exact type of information required.</p></li><li><p><strong>Uncertainty Acknowledgement</strong>: Explicitly request that the model should avoid making up information and express uncertainty when applicable, for example by saying &ldquo;I don&rsquo;t know&rdquo;.</p></li><li><p><strong>Emphasis on Key Information</strong>: Repeating important details within the prompt can help underline the importance of these elements. This helps ensure that they receive due attention in the model&rsquo;s response.</p></li><li><p><strong>Strategic Information Placement</strong>: Positioning the most crucial information towards the end of the prompt can enhance the model&rsquo;s focus on these key details.</p></li><li><p><strong>Output Format Specification</strong>: Directing the model to structure its response in a specific format can help in obtaining information that is organized in a manner that best suits the user&rsquo;s needs.</p></li></ul><p>Furthermore, more advanced <a href=https://www.promptingguide.ai>prompt engineering</a> techniques offer additional layers of sophistication:</p><ul><li><p><strong>Multi-shot Prompting</strong> involves providing the model with multiple examples of the desired output. This approach helps the model grasp the context better and align its responses with the expected answer format.</p></li><li><p><strong>Chain of Thought</strong> encourages the model to exhibit its reasoning process step-by-step, offering users insights into the logical progression leading to a given answer.</p></li><li><p><strong>Self-consistency</strong> involves generating several responses and selecting the one that demonstrates the highest degree of internal consistency, thereby improving reliability.</p></li><li><p><strong>Chain of Verification</strong> is a technique where the model is used to verify its outputs or make annotations, further enhancing the accuracy and trustworthiness of the information provided.</p></li></ul><h3 id=3-retrieval-based-approaches>3. Retrieval-based Approaches<a hidden class=anchor aria-hidden=true href=#3-retrieval-based-approaches>#</a></h3><p>These approaches enhance the model&rsquo;s responses by incorporating external knowledge sources and context to the prompt. Probably the most known technique is <strong>Retrieval Augmented Generation (RAG)</strong>:. This approach encodes external documents as <a href=https://en.wikipedia.org/wiki/Sentence_embedding>sentence embedding</a>, usually using some transformer-based neural network such as <a href=https://en.wikipedia.org/wiki/BERT_(language_model)>BERT</a>. The resulting embeddings are then stored in a <a href=https://en.wikipedia.org/wiki/Vector_database>vector database</a>, which can then be efficiently queried using the original prompt (or some variation). The retrieved sentences are then used to enrich the prompt. A popular framework is <a href=https://github.com/facebookresearch/faiss>FAISS</a>. The main drawback of these retrieval-based approaches is that they require maintaining a large and curated database.</p><h3 id=4-llm-fine-tuning>4. LLM Fine-tuning<a hidden class=anchor aria-hidden=true href=#4-llm-fine-tuning>#</a></h3><p>The quality of a model&rsquo;s output directly depends on its training data. Fine-tuning an LLM with updated or more relevant data can address specific weaknesses or gaps in its knowledge base. While retraining from scratch is often impractical, fine-tuning offers a cost-effective alternative for enhancing model accuracy in targeted applications. Techniques such as <a href=https://doi.org/10.48550/arXiv.2106.09685>LoRA</a> help reduce the number of trainable parameters which accelerates the fine-tuning making it a viable option.</p><h2 id=closing-thought>Closing Thought<a hidden class=anchor aria-hidden=true href=#closing-thought>#</a></h2><p>There is a fine line between creativity and hallucinations. On one hand, a model that leans too much towards caution may avoid hallucinations but at the cost of producing responses that are uninteresting or too simplistic. On the other hand, an overly creative model will produce outputs that resemble <a href="https://www.youtube.com/watch?v=A3FAy0teMNo">an interview with Salvador Dali</a>.</p><p>Finding the right balance is key to harnessing the full potential of LLM while minimizing the risks associated with hallucinations. Ultimately, understanding and mitigating hallucinations is not only about preventing errors; it&rsquo;s about building trust between humans and artificial intelligence, ensuring that these tools enhance our decision-making processes, creativity, and access to information.</p><h2 id=bibliography>Bibliography<a hidden class=anchor aria-hidden=true href=#bibliography>#</a></h2><ul><li><a href=https://doi.org/10.48550/arXiv.2311.05232>Huang et al. A Survey on Hallucination in Large Language Models: Principles, Taxonomy, Challenges, and Open Questions. (2023)</a></li><li><a href=https://doi.org/10.1145/3571730>Ji et al. Survey of Hallucination in Natural Language Generation. (2022)</a></li><li><a href=https://doi.org/10.48550/arXiv.2401.08358>Luo et al. Hallucination Detection and Hallucination Mitigation: An Investigation. (2024)</a></li><li><a href=https://doi.org/10.48550/arXiv.2303.08896>Manakul et al. SelfCheckGPT: Zero-Resource Black-Box Hallucination Detection for Generative Large Language Models. (2023)</a></li><li><a href=https://doi.org/10.48550/arXiv.2401.11817>Xu et al. Hallucination is Inevitable: An Innate Limitation of Large Language Models. (2024)</a></li><li><a href=https://doi.org/10.48550/arXiv.2011.02593>Zhou et al. Detecting Hallucinated Content in Conditional Neural Sequence Generation. (2020)</a></li></ul></div><footer class=post-footer><ul class=post-tags></ul><nav class=paginav><a class=next href=https://omfmartin.com/posts/2024-02-18-explainable-ai/><span class=title>Next »</span><br><span>A Quick Guide to Explainable AI</span></a></nav></footer></article></main><footer class=footer><span>&copy; 2025 <a href=https://omfmartin.com>Olivier MF Martin</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>